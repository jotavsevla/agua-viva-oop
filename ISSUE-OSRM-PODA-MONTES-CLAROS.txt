TITULO SUGERIDO
Integracao PoC M3-I3: podar grafo OSRM para Montes Claros por bounding box (4 coordenadas)

CONTEXTO
Hoje o preprocessamento OSRM usa dataset amplo (ex.: sudeste-latest), o que aumenta:
- tempo de build/preparo de dados,
- tamanho de artefato em disco,
- tempo de startup dos containers de rota/solver.

Para PoC-MVP, o dominio geografico principal e Montes Claros (MG). Faz sentido recortar o PBF
para a cidade (com margem operacional), reduzindo grafo fora de escopo.

OBJETIVO
Recortar o dataset OSM por um quadrado definido por 4 coordenadas (bounding box) e gerar
dataset OSRM dedicado a Montes Claros, mantendo qualidade de roteirizacao no perimetro da PoC.

BOUNDING BOX INICIAL PROPOSTA (Montes Claros + margem)
- min_lon (oeste): -43.9600
- min_lat (sul):   -16.8200
- max_lon (leste): -43.7800
- max_lat (norte): -16.6200

Escopo de cidade e ajustavel apos teste de cobertura de vias.

ESCOPO TECNICO
1. Adicionar etapa de poda no fluxo de preparo OSRM antes de osrm-extract:
   - usar `osmium extract --strategy=complete_ways --bbox=min_lon,min_lat,max_lon,max_lat`.
2. Gerar PBF recortado:
   - exemplo de saida: `montes-claros-bbox.osm.pbf`.
3. Processar dataset recortado com:
   - osrm-extract
   - osrm-partition
   - osrm-customize
4. Parametrizar script `solver/osrm/prepare.sh` para suportar:
   - `OSRM_BBOX=min_lon,min_lat,max_lon,max_lat`
   - `OSRM_DATASET_NAME=montes-claros-bbox` (opcional)
5. Manter fallback para fluxo atual (sem bbox) quando variavel nao for informada.
6. Atualizar compose/documentacao para subir OSRM com dataset recortado.

EXEMPLO DE COMANDO DA PODA (REFERENCIA)
docker run --rm -t -v "$(pwd):/data" ghcr.io/osmcode/osmium-tool:latest \
  extract --strategy=complete_ways \
  --bbox=-43.9600,-16.8200,-43.7800,-16.6200 \
  /data/sudeste-latest.osm.pbf \
  -o /data/montes-claros-bbox.osm.pbf --overwrite

CRITERIOS DE ACEITE
1. Funcional:
   - OSRM sobe com dataset recortado e responde `/health`.
   - Solver continua roteirizando pedidos seedados de Montes Claros sem erro.
2. Performance:
   - tempo total de preparo OSRM reduzido em pelo menos 40% vs baseline atual.
   - tamanho total dos arquivos `.osrm*` reduzido em pelo menos 60% vs baseline.
3. Qualidade:
   - cenario canonico feliz/falha/cancelamento passa com dataset recortado.
   - sem regressao de status final e sem violacao de invariantes de entrega.
4. Observabilidade:
   - registrar benchmark antes/depois em artifact (tempo + tamanho).

CHECKLIST DA ISSUE
- [ ] Medir baseline atual (tempo prepare + tamanho dataset + smoke de rota).
- [ ] Implementar poda por bbox no `prepare.sh`.
- [ ] Gerar dataset recortado e subir stack com `OSRM_DATASET` dedicado.
- [ ] Rodar suite PoC com seed de Montes Claros.
- [ ] Publicar benchmark e decisao de bbox final.

RISCOS E MITIGACAO
- Risco: bbox muito apertada cortar vias relevantes de acesso.
  Mitigacao: margem operacional + estrategia `complete_ways` + smoke de rotas em borda.
- Risco: regressao silenciosa de roteamento.
  Mitigacao: gate oficial de negocio + comparacao before/after com mesmos cenarios.
